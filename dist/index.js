"use strict";!function(){var queries={query:{fileName:"./query.json",dataset:"3ac1014020f747739532b031a35db536",id:"361e06e9eac7496f89a6d96b106d368c"}},query=queries.query,platform=new H.service.Platform({app_id:"in2pu7pura4wetagevAb",app_code:"py5JthxGeTnFXDNPQEIiRA",useCIT:!0,useHTTPS:!0}),pixelRatio=devicePixelRatio>1?2:1,defaultLayers=platform.createDefaultLayers({tileSize:256*pixelRatio}),map=new H.Map(document.getElementsByClassName("dl-map")[0],defaultLayers.normal.basenight,{pixelRatio:pixelRatio});window.addEventListener("resize",function(){map.getViewPort().resize()}),new H.mapevents.Behavior(new H.mapevents.MapEvents(map));var service=(H.ui.UI.createDefault(map,defaultLayers),platform.configure(new H.datalens.Service));service.fetchQueryStats(query.id,{stats:[{column_stats:{co2_ppm:["$min","$max","$average"],lat_avg:["$min","$max"],lon_avg:["$min","$max"]},dynamic:{x:"$drop",y:"$drop",z:15}}]}).then(function(_ref){var stats=_ref.stats,columnStats=stats[0].column_stats;map.setViewBounds(new H.geo.Rect(columnStats.lat_avg.$max,columnStats.lon_avg.$min,columnStats.lat_avg.$min,columnStats.lon_avg.$max),!1);var colorScale=d3.scaleLinear().range(["rgba(30, 68, 165, 0.03)","rgba(87, 164, 217, 0.8)","rgba(202, 248, 191, 0.8)"]).domain([0,.5,1]),bandwidth=[{value:.5,zoom:4},{value:4,zoom:17}],provider=new H.datalens.QueryTileProvider(service,{queryId:query.id,tileParamNames:{x:"x",y:"y",z:"z"}}),layer=new H.datalens.HeatmapLayer(provider,{rowToTilePoint:function(row){return{x:row.tx,y:row.ty,value:row.co2_ppm,count:1}},bandwidth:bandwidth,valueRange:{value:columnStats.co2_ppm.$average,zoom:4},colorScale:colorScale});map.addLayer(layer)})}();
